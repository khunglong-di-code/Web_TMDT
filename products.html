<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cửa Hàng | Tất Tần Tập</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="image/Tattantap_logo1.png" type="image/png">

  <style>
    /* --- CSS SẢN PHẨM (TO & RÕ) --- */
    .product-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr); /* Chia 2 cột đều nhau */
        gap: 40px;
        max-width: 1000px;
        margin: 0 auto;
    }

    .product-card {
        background: #fff;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border-radius: 12px;
        overflow: hidden; /* Bo góc ảnh */
        border: 1px solid #eee;
    }

    .product-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.1);
    }

    /* Ảnh sản phẩm to, cao */
    .product-img {
        width: 100%;
        height: 450px; /* Chiều cao cố định để ảnh to */
        object-fit: cover; /* Cắt ảnh vừa khung mà không bị méo */
        border-bottom: 1px solid #f0f0f0;
    }

    .product-info {
        padding: 25px;
        text-align: center;
    }

    .product-name {
        font-size: 1.4rem;
        margin-bottom: 10px;
        color: var(--secondary-color);
    }

    .product-price-preview {
        display: block;
        font-size: 1.1rem;
        color: var(--primary-color);
        font-weight: bold;
        margin-bottom: 15px;
    }

    .btn-select {
        background: var(--secondary-color);
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: 30px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
        width: 100%;
    }
    
    .btn-select:hover {
        background: var(--primary-color);
        transform: scale(1.02);
    }

    /* --- RESPONSIVE MOBILE --- */
    @media (max-width: 768px) {
        .product-grid {
            grid-template-columns: 1fr; /* Mobile hiện 1 cột dọc */
        }
        .product-img {
            height: 350px; /* Mobile ảnh thấp hơn chút */
        }
    }

    /* --- CSS POP-UP TRƯỢT (SLIDING SHEET) --- */
    .popup-overlay {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.6);
        z-index: 2000;
        opacity: 0; visibility: hidden;
        transition: all 0.3s ease;
        backdrop-filter: blur(2px); /* Làm mờ nền sau */
    }
    .popup-overlay.active { opacity: 1; visibility: visible; }

    .sliding-sheet {
        position: fixed;
        bottom: -100%; left: 50%;
        transform: translateX(-50%);
        width: 100%; max-width: 500px;
        background: white;
        border-radius: 20px 20px 0 0;
        padding: 25px;
        z-index: 2001;
        transition: bottom 0.4s cubic-bezier(0.19, 1, 0.22, 1);
        box-shadow: 0 -10px 40px rgba(0,0,0,0.2);
        max-height: 85vh;
        overflow-y: auto;
    }
    .sliding-sheet.active { bottom: 0; }

    .sheet-header {
        display: flex; justify-content: space-between; align-items: flex-start;
        margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px;
    }
    .sheet-info h3 { margin: 0 0 5px 0; font-size: 1.3rem; color: var(--secondary-color); }
    .sheet-price { color: var(--primary-color); font-weight: bold; font-size: 1.2rem; }
    .sheet-close { background: none; border: none; font-size: 1.8rem; cursor: pointer; color: #999; }
    
    .sheet-body img {
        width: 120px; height: 120px; object-fit: cover; border-radius: 12px;
        float: left; margin-right: 20px; border: 1px solid #eee;
    }
    
    .option-group { margin-bottom: 20px; clear: both; }
    .option-group label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 0.95rem; color: #444; }
    .option-group select, .option-group input {
        width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; outline: none;
    }
    .option-group select:focus, .option-group input:focus { border-color: var(--primary-color); }

    .btn-add-cart {
        width: 100%; background: var(--primary-color); color: white;
        padding: 16px; border: none; border-radius: 12px;
        font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 10px;
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="site-header">
    <div class="header-inner">
      <a class="logo" href="index.html">
        <img src="image/Tattantap_logo1.png" alt="Logo">
      </a>
      <nav class="main-nav">
        <ul>
          <li><a href="index.html">Trang chủ</a></li>      
          <li><a href="about.html">Về chúng tôi</a></li>
          <li><a href="products.html" class="active">Cửa hàng</a></li>
          <li><a href="faq.html">Hỗ trợ</a></li>
        </ul>
      </nav>
      <div class="header-actions">
          <a class="cart-link" href="cart.html">
            <i class="fa-solid fa-bag-shopping"></i>
            <span class="cart-count" id="cart-count">0</span>
          </a>
      </div>
    </div>
  </header>

  <section class="section bg-light" style="padding: 40px 5%; text-align: center;">
    <div class="container">
      <h1 style="font-size: 2rem; color: var(--secondary-color);">Cửa Hàng</h1>
      <p style="color: var(--text-gray);">Chạm vào sản phẩm để xem chi tiết</p>
    </div>
  </section>

  <!-- PHẦN HIỂN THỊ 2 SẢN PHẨM (TO & RÕ) -->
  <section class="section">
    <div class="container">
      <div class="product-grid">

        <!-- SẢN PHẨM 1: TẤT (Ảnh Tất trắng) -->
        <article class="product-card" onclick="openPopup('sock')">
          <img src="image/1.png" class="product-img" alt="Tất Cotton Premium">
          <div class="product-info">
            <h3 class="product-name">Tất Cotton Premium</h3>
            <span class="product-price-preview">Chỉ từ 6.000₫</span>
            <button class="btn-select">Chọn phân loại</button>
          </div>
        </article>

        <!-- SẢN PHẨM 2: SỔ (Ảnh Sổ tay) -->
        <article class="product-card" onclick="openPopup('book')">
          <img src="image/4.png" class="product-img" alt="Sổ Tay Minimalist">
          <div class="product-info">
            <h3 class="product-name">Sổ Tay Minimalist</h3>
            <span class="product-price-preview">35.000₫</span>
            <button class="btn-select">Thêm vào giỏ</button>
          </div>
        </article>

      </div>
    </div>
  </section>

  <!-- KHUNG POP-UP TRƯỢT (SLIDING SHEET) -->
  <div class="popup-overlay" id="popup-overlay" onclick="closePopup()"></div>
  
  <div class="sliding-sheet" id="product-sheet">
      <div class="sheet-header">
          <div class="sheet-info">
              <h3 id="popup-name">Tên Sản Phẩm</h3>
              <div class="sheet-price" id="popup-price">0₫</div>
          </div>
          <button class="sheet-close" onclick="closePopup()"><i class="fa-solid fa-xmark"></i></button>
      </div>

      <div class="sheet-body">
          <img id="popup-img" src="" alt="Ảnh chi tiết">
          
          <!-- Các tùy chọn cho Tất -->
          <div id="sock-options">
              <div class="option-group">
                  <label>Kích thước (Size):</label>
                  <select id="size-sock" onchange="updatePopupState()">
                      <option value="S">Nhỏ (S)</option>
                      <option value="M">Vừa (M)</option>
                      <option value="L">Lớn (L)</option>
                  </select>
              </div>

              <div class="option-group">
                  <label>Màu sắc:</label>
                  <select id="color-sock" onchange="updatePopupState()">
                      <option value="Trắng">Trắng</option>
                      <option value="Đen">Đen</option>
                  </select>
              </div>
          </div>

          <div class="option-group">
              <label>Số lượng:</label>
              <input type="number" id="popup-qty" value="1" min="1" onchange="updatePopupState()">
          </div>
          
          <div style="clear:both;"></div>
      </div>

      <div class="sheet-footer">
          <button class="btn-add-cart" onclick="confirmAddToCart()">Xác Nhận Thêm</button>
      </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <style>
        .copyright-container { display: flex; justify-content: space-between; align-items: center; width: 100%; }
        .social-bottom-right { display: flex; gap: 15px; }
        .social-bottom-right a { color: inherit; font-size: 20px; text-decoration: none; opacity: 0.8; transition: 0.3s; }
        .social-bottom-right a:hover { opacity: 1; transform: scale(1.1); }
        .bct-logo { width: 150px; margin-top: 15px; display: block; }
    </style>

    <div class="footer-grid">
      <div class="footer-col">
        <h4>Về Tất Tần Tập</h4>
        <p>Chúng tôi cung cấp các sản phẩm văn phòng phẩm và phụ kiện thời trang tối giản, chất lượng cao với mức giá hợp lý.</p>
        <a href="http://online.gov.vn/Home/WebDetails/10940" target="_blank">
            <img src="image_dcd887.png" alt="Đã thông báo Bộ Công Thương" class="bct-logo">
        </a>
      </div>
      <div class="footer-col">
        <h4>Liên Hệ</h4>
        <p><i class="fa-solid fa-location-dot"></i> Hai Bà Trưng, Hà Nội</p>
        <p><i class="fa-solid fa-phone"></i> 0967 067 332</p>
        <p><i class="fa-solid fa-envelope"></i> lienhe@tattantap.com</p>
      </div>
      <div class="footer-col">
        <h4>Hỗ Trợ</h4>
        <ul>
          <li><a href="faq.html">Câu hỏi thường gặp</a></li>
          <li><a href="#">Chính sách đổi trả</a></li>
          <li><a href="#">Hướng dẫn mua hàng</a></li>
        </ul>
      </div>
    </div>
    <div class="copyright">
        <div class="copyright-container">
            <span>© 2025 Bản quyền thuộc về Tất Tần Tập. Thiết kế bởi Đào Tất Thành.</span>
            <div class="social-bottom-right">
                <a href="https://www.instagram.com/tattantap/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                <a href="https://www.facebook.com/profile.php?id=61582495130534" target="_blank"><i class="fa-brands fa-facebook"></i></a>
            </div>
        </div>
    </div>
  </footer>

  <!-- Chat Plugin -->
  <div id="fb-root"></div>
  <div id="fb-customer-chat" class="fb-customerchat"></div>
  <script>
    var chatbox = document.getElementById('fb-customer-chat');
    chatbox.setAttribute("page_id", "61582495130534");
    chatbox.setAttribute("attribution", "biz_inbox");
    window.fbAsyncInit = function() { FB.init({ xfbml : true, version : 'v18.0' }); };
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = 'https://connect.facebook.net/vi_VN/sdk/xfbml.customerchat.js';
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
  </script>

  <!-- LOGIC POPUP & CART -->
  <script>
      // 1. KHO ẢNH
      const sockImages = {
          "S_Đen": "image/conganden.png",
          "M_Đen": "image/colung1den.png",
          "L_Đen": "image/codaiden.png",
          "S_Trắng": "image/1.png",
          "M_Trắng": "image/tatcolung1.jpg",
          "L_Trắng": "image/tatcodai.jpg"
      };
      
      let currentProductType = '';

      // 2. MỞ POPUP
      function openPopup(type) {
          currentProductType = type;
          const sheet = document.getElementById('product-sheet');
          const overlay = document.getElementById('popup-overlay');
          const sockOptions = document.getElementById('sock-options');
          const qtyInput = document.getElementById('popup-qty');
          const imgElement = document.getElementById('popup-img');

          qtyInput.value = 1;

          if (type === 'sock') {
              document.getElementById('popup-name').innerText = "Tất Cotton Premium";
              sockOptions.style.display = 'block';
              document.getElementById('size-sock').value = 'S';
              document.getElementById('color-sock').value = 'Trắng';
          } else {
              // CẤU HÌNH CHO SỔ
              document.getElementById('popup-name').innerText = "Sổ Tay Minimalist";
              sockOptions.style.display = 'none'; // Ẩn chọn size/màu
              imgElement.src = "image/4.png"; // <-- Đặt ảnh sổ ở đây
          }

          updatePopupState();
          overlay.classList.add('active');
          sheet.classList.add('active');
      }

      // 3. ĐÓNG POPUP
      function closePopup() {
          document.getElementById('product-sheet').classList.remove('active');
          document.getElementById('popup-overlay').classList.remove('active');
      }

      // 4. CẬP NHẬT TRẠNG THÁI POPUP
      function updatePopupState() {
          const qty = parseInt(document.getElementById('popup-qty').value) || 1;
          const priceLabel = document.getElementById('popup-price');
          const imgElement = document.getElementById('popup-img');

          if (currentProductType === 'sock') {
              const size = document.getElementById('size-sock').value;
              const color = document.getElementById('color-sock').value;

              // Đổi ảnh tất theo size/màu
              const key = size + "_" + color;
              imgElement.src = sockImages[key] || 'image/1.png';

              let unitPrice = 0;
              if (size === 'S') unitPrice = (qty >= 10) ? 6000 : (qty >= 5) ? 8000 : 10000;
              else if (size === 'M') unitPrice = (qty >= 10) ? 8000 : (qty >= 5) ? 10000 : 12000;
              else if (size === 'L') unitPrice = (qty >= 10) ? 10000 : (qty >= 5) ? 12000 : 14000;

              priceLabel.innerHTML = `${unitPrice.toLocaleString('vi-VN')}₫`;
          } else {
              // Giá Sổ tay (Cố định 35k)
              const unitPrice = 35000;
              // Nếu bạn có nhiều ảnh sổ, logic đổi ảnh sổ sẽ nằm ở đây, hiện tại cố định 1 ảnh
              // imgElement.src = "image/4.png"; 
              priceLabel.innerHTML = `${unitPrice.toLocaleString('vi-VN')}₫`;
          }
      }

      // 5. THÊM VÀO GIỎ
      function confirmAddToCart() {
          let product = {};
          const qty = parseInt(document.getElementById('popup-qty').value);

          if (currentProductType === 'sock') {
              const size = document.getElementById('size-sock').value;
              const color = document.getElementById('color-sock').value;
              const sizeName = (size === 'S') ? "Nhỏ" : (size === 'M') ? "Vừa" : "Lớn";
              
              let price = 0;
              if (size === 'S') price = (qty >= 10) ? 6000 : (qty >= 5) ? 8000 : 10000;
              else if (size === 'M') price = (qty >= 10) ? 8000 : (qty >= 5) ? 10000 : 12000;
              else if (size === 'L') price = (qty >= 10) ? 10000 : (qty >= 5) ? 12000 : 14000;

              product = {
                  id: 'sock_' + size + '_' + color, 
                  name: `Tất Cotton (${sizeName} - ${color})`,
                  type: 'sock',
                  size: size,
                  color: color,
                  price: price,
                  quantity: qty,
                  image: document.getElementById('popup-img').src
              };
          } else {
              product = {
                  id: 'book_std',
                  name: 'Sổ Tay Minimalist',
                  type: 'book',
                  price: 35000,
                  quantity: qty,
                  image: 'image/4.png'
              };
          }

          let cart = JSON.parse(localStorage.getItem('myCart')) || [];
          let existingItem = cart.find(item => item.id === product.id);
          
          if (existingItem) {
              existingItem.quantity += product.quantity;
          } else {
              cart.push(product);
          }
          localStorage.setItem('myCart', JSON.stringify(cart));
          updateCartCount();
          closePopup();
          alert(`Đã thêm "${product.name}" vào giỏ hàng!`);
      }

      function updateCartCount() {
          let cart = JSON.parse(localStorage.getItem('myCart')) || [];
          let total = 0;
          cart.forEach(item => total += parseInt(item.quantity));
          document.getElementById('cart-count').innerText = total;
      }

      updateCartCount();
  </script>

</body>
</html>
